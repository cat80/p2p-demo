p2sp 项目介绍

### 项目目标
该项目主要是为了深入了解网络编程来开发。

项目采用阻塞式IO和多线程处理消息请求，自定义二进制协议通信。客户端之间通信通过服务端代理转发的方式完成。


### 已经完成的功能有 

用户连接服务器后，需要先/reg 一个用户名才能使用。服务端有block用户的功能，客户端是没有。做了权限隔离

服务端：

1.查看当前在线的用户列表
2.移除用户下线
3.广播群发消息
4.给单个用户私发

客户端：：
1.注册
2.广播群发消息
3.私发消息
4.广播消息
5.给单个用户私发

### 项目结构

protocol.py 协议定义文件，服务端和客户端都需要引用。使用二进制加变长的payload传输数据.
server.py 服务端程序。没有依赖任何第三方库，可以直接启动。
client.py 客户端程序。同样没有依赖任何第三方库，可以直接启动。

test/ 目录，单元测试主要针对protocol.py进行测试

### 项目运行
在有一终端运行服务端：

python server.py

在多个终端运行客户端：

python client.py
python client.py
python client.py

使用/help命令查看可用的用户以及解释。非/开头的系统则会进行群发。

成功启动后。的效果如下。md-img/图片目录。AI你帮我引用进来。


### 项目计划

1. 该项目主要是研究使用p2sp架构的网络编程，以及阻塞、多线程模型开发网络应用遇到的问题，如性能低，状态管理麻烦。为接下来使使用epoll的单线程+asyncio异步网络开发提供基础。项目没身没有很多实用价值，但对学习网络编程，了解网络架构是一个很好的赳点。
2. 虽然项目只有三个文件，也把协议部分离出来了，并且对协议的定义做了单元测试。但如果想做为一个生产项目远远不足的，需要改进的方向有；

   - 项目架构的优化，要尽量把模块解耦。比如，协议定义，消息处理、连接管理、通知等部分，以方便扩展和单元测试。网络程序不管是多线程还是异步，规模大了后非常容易出现问题。如果不能尽量高的单元测试覆盖，开发的难度是让会抓狂的。
   - 协议定义的优化。目前协议定义是通用的，客户端和服务端用一套，在实际过程中会有点混乱。应该像http的设计那样，把request和response协议分开出来。而且在消息处理下，应该采用消息队队和事件订阅分的方式来解耦。提高代码的稳定性。
   - 该项目本身的工程问题。边界检察问题、异常处理问题、还有控制台的输入体验，都有很大的优化空间。在连接池管理方面也不存在很多问题，这个在下一个异步管理中完善。
   - 就聊天整体的功能来讲，需要数据库持久化用户信息，保证用户体验。还有就是离线消息支持，重连的问题。





